alert:
- debug
description: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location
filter:
- query:
    query_string:
      query: (data.win.system.eventID:"4688" AND ((((((((((((process_path:*\\CamMute.exe AND (NOT (process_path:(*\\Lenovo\\Communication\ Utility\\* OR *\\Lenovo\\Communications\ Utility\\*)))) OR (process_path:*\\chrome_frame_helper.exe AND (NOT (process_path:*\\Google\\Chrome\\application\\*)))) OR (process_path:*\\dvcemumanager.exe AND (NOT (process_path:*\\Microsoft\ Device\ Emulator\\*)))) OR (process_path:*\\Gadget.exe AND (NOT (process_path:*\\Windows\ Media\ Player\\*)))) OR (process_path:*\\hcc.exe AND (NOT (process_path:*\\HTML\ Help\ Workshop\\*)))) OR (process_path:*\\hkcmd.exe AND (NOT (process_path:(*\\System32\\* OR *\\SysNative\\* OR *\\SysWowo64\\*))))) OR (process_path:*\\Mc.exe AND (NOT (process_path:(*\\Microsoft\ Visual\ Studio* OR *\\Microsoft\ SDK* OR *\\Windows\ Kit*))))) OR (process_path:*\\MsMpEng.exe AND (NOT (process_path:(*\\Microsoft\ Security\ Client\\* OR *\\Windows\ Defender\\* OR *\\AntiMalware\\*))))) OR (process_path:*\\msseces.exe AND (NOT (process_path:(*\\Microsoft\ Security\ Center\\* OR *\\Microsoft\ Security\ Client\\* OR *\\Microsoft\ Security\ Essentials\\*))))) OR (process_path:*\\OInfoP11.exe AND (NOT (process_path:*\\Common\ Files\\Microsoft\ Shared\\*)))) OR (process_path:*\\OleView.exe AND (NOT (process_path:(*\\Microsoft\ Visual\ Studio* OR *\\Microsoft\ SDK* OR *\\Windows\ Kit* OR *\\Windows\ Resource\ Kit\\*))))) OR (process_path:*\\rc.exe AND (NOT (process_path:(*\\Microsoft\ Visual\ Studio* OR *\\Microsoft\ SDK* OR *\\Windows\ Kit* OR *\\Windows\ Resource\ Kit\\* OR *\\Microsoft.NET\\*))))))
index: wazuh-alerts-3.x-*
name: Executable-Used-by-PlugX-in-Uncommon-Location
priority: 2
realert:
  minutes: 0
type: any


