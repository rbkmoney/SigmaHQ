alert:
- debug
description: Detects various anomalies in relation to regsvr32.exe
filter:
- query:
    query_string:
      query: (data.win.system.eventID:"1" AND ((data.win.eventdata.image:*\\regsvr32.exe AND data.win.eventdata.commandLine:*\\Temp\\*) OR (data.win.eventdata.image:*\\regsvr32.exe AND data.win.eventdata.parentImage:*\\powershell.exe) OR (data.win.eventdata.image:*\\regsvr32.exe AND data.win.eventdata.parentImage:*\\cmd.exe) OR (data.win.eventdata.image:*\\regsvr32.exe AND data.win.eventdata.commandLine:*\/i\:* AND data.win.eventdata.commandLine:(*http* OR *ftp*) AND data.win.eventdata.commandLine:*scrobj.dll) OR (data.win.eventdata.image:*\\wscript.exe AND data.win.eventdata.parentImage:*\\regsvr32.exe) OR (data.win.eventdata.image:*\\EXCEL.EXE AND data.win.eventdata.commandLine:*..\\..\\..\\Windows\\System32\\regsvr32.exe\ *)))
index: wazuh-alerts-3.x-*
name: Regsvr32-Anomaly
priority: 2
realert:
  minutes: 0
type: any


